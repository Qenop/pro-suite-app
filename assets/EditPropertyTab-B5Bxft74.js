import{u as I,r as c,j as a,a as L}from"./index-Dn5Gdufi.js";const O=()=>{var C,P;const{property:t,refreshProperty:M}=I(),[r,N]=c.useState(null),[s,q]=c.useState({}),[j,w]=c.useState(!1),[R,g]=c.useState(""),[D,f]=c.useState("");c.useEffect(()=>{var e,d,o,i,n,u,m,y,x,h,b,v;t&&N({propertyName:t.propertyName||"",address:t.address||"",propertyType:t.propertyType||"",serviceRate:{model:((e=t.serviceRate)==null?void 0:e.model)||"",value:((d=t.serviceRate)==null?void 0:d.value)||""},landlord:{name:((o=t.landlord)==null?void 0:o.name)||"",email:((i=t.landlord)==null?void 0:i.email)||"",phone:((n=t.landlord)==null?void 0:n.phone)||""},paymentDetails:{bank:((u=t.paymentDetails)==null?void 0:u.bank)||"",accountName:((m=t.paymentDetails)==null?void 0:m.accountName)||"",accountNumber:((y=t.paymentDetails)==null?void 0:y.accountNumber)||"",deadline:((x=t.paymentDetails)==null?void 0:x.deadline)||""},utilities:{water:((h=t.utilities)==null?void 0:h.water)||"",waterRate:((b=t.utilities)==null?void 0:b.waterRate)||"",garbage:((v=t.utilities)==null?void 0:v.garbage)||""}})},[t]);const l=(e,d,o)=>{const i=e.target.value;N(d?n=>({...n,[d]:{...n[d],[o]:i}}):n=>({...n,[o]:i}))},A=()=>{const e={};return r.propertyName||(e.propertyName="Name is required."),r.address||(e.address="Address is required."),r.propertyType||(e.propertyType="Type is required."),(!r.serviceRate.model||!r.serviceRate.value)&&(e.serviceRate={...r.serviceRate.model?{}:{model:"Model is required."},...r.serviceRate.value?{}:{value:"Value is required."}}),e},E=async e=>{var o,i,n,u,m,y,x,h,b,v,T,S,k,F;e.preventDefault();const d=A();if(q(d),!(Object.keys(d).length>0))try{w(!0),f(""),g(""),(await L.put(`/properties/${t._id}`,r)).status===200?(g("Property updated successfully."),await M(),N({propertyName:t.propertyName||"",address:t.address||"",propertyType:t.propertyType||"",serviceRate:{model:((o=t.serviceRate)==null?void 0:o.model)||"",value:((i=t.serviceRate)==null?void 0:i.value)||""},landlord:{name:((n=t.landlord)==null?void 0:n.name)||"",email:((u=t.landlord)==null?void 0:u.email)||"",phone:((m=t.landlord)==null?void 0:m.phone)||""},paymentDetails:{bank:((y=t.paymentDetails)==null?void 0:y.bank)||"",accountName:((x=t.paymentDetails)==null?void 0:x.accountName)||"",accountNumber:((h=t.paymentDetails)==null?void 0:h.accountNumber)||"",deadline:((b=t.paymentDetails)==null?void 0:b.deadline)||""},utilities:{water:((v=t.utilities)==null?void 0:v.water)||"",waterRate:((T=t.utilities)==null?void 0:T.waterRate)||"",garbage:((S=t.utilities)==null?void 0:S.garbage)||""}})):(f("Failed to update property."),g(""))}catch(p){console.error("Property update error:",p.response||p.message||p),f(((F=(k=p==null?void 0:p.response)==null?void 0:k.data)==null?void 0:F.message)||"Failed to update property."),g("")}finally{w(!1)}};return r?a.jsxs("form",{onSubmit:E,className:"p-6 bg-white rounded-lg shadow space-y-6",children:[a.jsxs("section",{children:[a.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Basic Info"}),a.jsx("input",{type:"text",placeholder:"Property Name",className:"w-full mb-2 border px-3 py-2 rounded",value:r.propertyName,onChange:e=>l(e,null,"propertyName")}),s.propertyName&&a.jsx("p",{className:"text-red-600 text-sm",children:s.propertyName}),a.jsx("input",{type:"text",placeholder:"Address",className:"w-full mb-2 border px-3 py-2 rounded",value:r.address,onChange:e=>l(e,null,"address")}),s.address&&a.jsx("p",{className:"text-red-600 text-sm",children:s.address}),a.jsx("input",{type:"text",placeholder:"Property Type",className:"w-full mb-2 border px-3 py-2 rounded",value:r.propertyType,onChange:e=>l(e,null,"propertyType")}),s.propertyType&&a.jsx("p",{className:"text-red-600 text-sm",children:s.propertyType})]}),a.jsxs("section",{children:[a.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Service Rate"}),a.jsxs("select",{className:"w-full mb-2 border px-3 py-2 rounded",value:r.serviceRate.model,onChange:e=>l(e,"serviceRate","model"),children:[a.jsx("option",{value:"",children:"Select Model"}),a.jsx("option",{value:"Fixed",children:"Fixed"}),a.jsx("option",{value:"Percent",children:"Percent"})]}),((C=s==null?void 0:s.serviceRate)==null?void 0:C.model)&&a.jsx("p",{className:"text-red-600 text-sm",children:s.serviceRate.model}),r.serviceRate.model&&a.jsx("input",{type:"number",placeholder:r.serviceRate.model==="Fixed"?"Amount (Kes.)":"Percentage (%)",className:"w-full mb-2 border px-3 py-2 rounded",value:r.serviceRate.value,onChange:e=>l(e,"serviceRate","value")}),((P=s==null?void 0:s.serviceRate)==null?void 0:P.value)&&a.jsx("p",{className:"text-red-600 text-sm",children:s.serviceRate.value})]}),a.jsxs("section",{children:[a.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Landlord Info"}),a.jsx("input",{type:"text",placeholder:"Name",className:"w-full mb-2 border px-3 py-2 rounded",value:r.landlord.name,onChange:e=>l(e,"landlord","name")}),a.jsx("input",{type:"email",placeholder:"Email",className:"w-full mb-2 border px-3 py-2 rounded",value:r.landlord.email,onChange:e=>l(e,"landlord","email")}),a.jsx("input",{type:"tel",placeholder:"Phone",className:"w-full mb-2 border px-3 py-2 rounded",value:r.landlord.phone,onChange:e=>l(e,"landlord","phone")})]}),a.jsxs("section",{children:[a.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Payment Details"}),a.jsx("input",{type:"text",placeholder:"Bank",className:"w-full mb-2 border px-3 py-2 rounded",value:r.paymentDetails.bank,onChange:e=>l(e,"paymentDetails","bank")}),a.jsx("input",{type:"text",placeholder:"Account Name",className:"w-full mb-2 border px-3 py-2 rounded",value:r.paymentDetails.accountName,onChange:e=>l(e,"paymentDetails","accountName")}),a.jsx("input",{type:"text",placeholder:"Account Number",className:"w-full mb-2 border px-3 py-2 rounded",value:r.paymentDetails.accountNumber,onChange:e=>l(e,"paymentDetails","accountNumber")}),a.jsx("input",{type:"text",placeholder:"Payment Deadline",className:"w-full mb-2 border px-3 py-2 rounded",value:r.paymentDetails.deadline,onChange:e=>l(e,"paymentDetails","deadline")})]}),a.jsxs("section",{children:[a.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Utilities"}),a.jsx("input",{type:"text",placeholder:"Water",className:"w-full mb-2 border px-3 py-2 rounded",value:r.utilities.water,onChange:e=>l(e,"utilities","water")}),a.jsx("input",{type:"text",placeholder:"Water Rate",className:"w-full mb-2 border px-3 py-2 rounded",value:r.utilities.waterRate,onChange:e=>l(e,"utilities","waterRate")}),a.jsx("input",{type:"text",placeholder:"Garbage",className:"w-full mb-2 border px-3 py-2 rounded",value:r.utilities.garbage,onChange:e=>l(e,"utilities","garbage")})]}),a.jsx("button",{type:"submit",disabled:j,className:"bg-cyan-700 text-white px-6 py-2 rounded hover:bg-black",children:j?"Saving...":"Update Property"}),R&&a.jsx("p",{className:"mt-3 text-green-600 font-medium",children:R}),D&&a.jsx("p",{className:"mt-3 text-red-600 font-medium",children:D})]}):a.jsx("p",{children:"Loading..."})};export{O as default};
