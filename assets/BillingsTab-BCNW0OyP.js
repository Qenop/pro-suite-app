import{g as te,u as re,r as I,j as u,a as Z}from"./index-CIGkXiIJ.js";var U={exports:{}},ne=U.exports,V;function se(){return V||(V=1,function(y,j){(function(C,N){y.exports=N()})(ne,function(){var C=1e3,N=6e4,H=36e5,k="millisecond",g="second",D="minute",m="hour",v="day",Y="week",c="month",M="quarter",b="year",T="date",q="Invalid Date",Q=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,K=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,X={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(s){var r=["th","st","nd","rd"],e=s%100;return"["+s+(r[(e-20)%10]||r[e]||r[0])+"]"}},J=function(s,r,e){var n=String(s);return!n||n.length>=r?s:""+Array(r+1-n.length).join(e)+s},ee={s:J,z:function(s){var r=-s.utcOffset(),e=Math.abs(r),n=Math.floor(e/60),t=e%60;return(r<=0?"+":"-")+J(n,2,"0")+":"+J(t,2,"0")},m:function s(r,e){if(r.date()<e.date())return-s(e,r);var n=12*(e.year()-r.year())+(e.month()-r.month()),t=r.clone().add(n,c),a=e-t<0,i=r.clone().add(n+(a?-1:1),c);return+(-(n+(e-t)/(a?t-i:i-t))||0)},a:function(s){return s<0?Math.ceil(s)||0:Math.floor(s)},p:function(s){return{M:c,y:b,w:Y,d:v,D:T,h:m,m:D,s:g,ms:k,Q:M}[s]||String(s||"").toLowerCase().replace(/s$/,"")},u:function(s){return s===void 0}},L="en",S={};S[L]=X;var z="$isDayjsObject",R=function(s){return s instanceof F||!(!s||!s[z])},A=function s(r,e,n){var t;if(!r)return L;if(typeof r=="string"){var a=r.toLowerCase();S[a]&&(t=a),e&&(S[a]=e,t=a);var i=r.split("-");if(!t&&i.length>1)return s(i[0])}else{var l=r.name;S[l]=r,t=l}return!n&&t&&(L=t),t||!n&&L},h=function(s,r){if(R(s))return s.clone();var e=typeof r=="object"?r:{};return e.date=s,e.args=arguments,new F(e)},o=ee;o.l=A,o.i=R,o.w=function(s,r){return h(s,{locale:r.$L,utc:r.$u,x:r.$x,$offset:r.$offset})};var F=function(){function s(e){this.$L=A(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[z]=!0}var r=s.prototype;return r.parse=function(e){this.$d=function(n){var t=n.date,a=n.utc;if(t===null)return new Date(NaN);if(o.u(t))return new Date;if(t instanceof Date)return new Date(t);if(typeof t=="string"&&!/Z$/i.test(t)){var i=t.match(Q);if(i){var l=i[2]-1||0,d=(i[7]||"0").substring(0,3);return a?new Date(Date.UTC(i[1],l,i[3]||1,i[4]||0,i[5]||0,i[6]||0,d)):new Date(i[1],l,i[3]||1,i[4]||0,i[5]||0,i[6]||0,d)}}return new Date(t)}(e),this.init()},r.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},r.$utils=function(){return o},r.isValid=function(){return this.$d.toString()!==q},r.isSame=function(e,n){var t=h(e);return this.startOf(n)<=t&&t<=this.endOf(n)},r.isAfter=function(e,n){return h(e)<this.startOf(n)},r.isBefore=function(e,n){return this.endOf(n)<h(e)},r.$g=function(e,n,t){return o.u(e)?this[n]:this.set(t,e)},r.unix=function(){return Math.floor(this.valueOf()/1e3)},r.valueOf=function(){return this.$d.getTime()},r.startOf=function(e,n){var t=this,a=!!o.u(n)||n,i=o.p(e),l=function(O,p){var w=o.w(t.$u?Date.UTC(t.$y,p,O):new Date(t.$y,p,O),t);return a?w:w.endOf(v)},d=function(O,p){return o.w(t.toDate()[O].apply(t.toDate("s"),(a?[0,0,0,0]:[23,59,59,999]).slice(p)),t)},f=this.$W,$=this.$M,x=this.$D,B="set"+(this.$u?"UTC":"");switch(i){case b:return a?l(1,0):l(31,11);case c:return a?l(1,$):l(0,$+1);case Y:var _=this.$locale().weekStart||0,W=(f<_?f+7:f)-_;return l(a?x-W:x+(6-W),$);case v:case T:return d(B+"Hours",0);case m:return d(B+"Minutes",1);case D:return d(B+"Seconds",2);case g:return d(B+"Milliseconds",3);default:return this.clone()}},r.endOf=function(e){return this.startOf(e,!1)},r.$set=function(e,n){var t,a=o.p(e),i="set"+(this.$u?"UTC":""),l=(t={},t[v]=i+"Date",t[T]=i+"Date",t[c]=i+"Month",t[b]=i+"FullYear",t[m]=i+"Hours",t[D]=i+"Minutes",t[g]=i+"Seconds",t[k]=i+"Milliseconds",t)[a],d=a===v?this.$D+(n-this.$W):n;if(a===c||a===b){var f=this.clone().set(T,1);f.$d[l](d),f.init(),this.$d=f.set(T,Math.min(this.$D,f.daysInMonth())).$d}else l&&this.$d[l](d);return this.init(),this},r.set=function(e,n){return this.clone().$set(e,n)},r.get=function(e){return this[o.p(e)]()},r.add=function(e,n){var t,a=this;e=Number(e);var i=o.p(n),l=function($){var x=h(a);return o.w(x.date(x.date()+Math.round($*e)),a)};if(i===c)return this.set(c,this.$M+e);if(i===b)return this.set(b,this.$y+e);if(i===v)return l(1);if(i===Y)return l(7);var d=(t={},t[D]=N,t[m]=H,t[g]=C,t)[i]||1,f=this.$d.getTime()+e*d;return o.w(f,this)},r.subtract=function(e,n){return this.add(-1*e,n)},r.format=function(e){var n=this,t=this.$locale();if(!this.isValid())return t.invalidDate||q;var a=e||"YYYY-MM-DDTHH:mm:ssZ",i=o.z(this),l=this.$H,d=this.$m,f=this.$M,$=t.weekdays,x=t.months,B=t.meridiem,_=function(p,w,E,P){return p&&(p[w]||p(n,a))||E[w].slice(0,P)},W=function(p){return o.s(l%12||12,p,"0")},O=B||function(p,w,E){var P=p<12?"AM":"PM";return E?P.toLowerCase():P};return a.replace(K,function(p,w){return w||function(E){switch(E){case"YY":return String(n.$y).slice(-2);case"YYYY":return o.s(n.$y,4,"0");case"M":return f+1;case"MM":return o.s(f+1,2,"0");case"MMM":return _(t.monthsShort,f,x,3);case"MMMM":return _(x,f);case"D":return n.$D;case"DD":return o.s(n.$D,2,"0");case"d":return String(n.$W);case"dd":return _(t.weekdaysMin,n.$W,$,2);case"ddd":return _(t.weekdaysShort,n.$W,$,3);case"dddd":return $[n.$W];case"H":return String(l);case"HH":return o.s(l,2,"0");case"h":return W(1);case"hh":return W(2);case"a":return O(l,d,!0);case"A":return O(l,d,!1);case"m":return String(d);case"mm":return o.s(d,2,"0");case"s":return String(n.$s);case"ss":return o.s(n.$s,2,"0");case"SSS":return o.s(n.$ms,3,"0");case"Z":return i}return null}(p)||i.replace(":","")})},r.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},r.diff=function(e,n,t){var a,i=this,l=o.p(n),d=h(e),f=(d.utcOffset()-this.utcOffset())*N,$=this-d,x=function(){return o.m(i,d)};switch(l){case b:a=x()/12;break;case c:a=x();break;case M:a=x()/3;break;case Y:a=($-f)/6048e5;break;case v:a=($-f)/864e5;break;case m:a=$/H;break;case D:a=$/N;break;case g:a=$/C;break;default:a=$}return t?a:o.a(a)},r.daysInMonth=function(){return this.endOf(c).$D},r.$locale=function(){return S[this.$L]},r.locale=function(e,n){if(!e)return this.$L;var t=this.clone(),a=A(e,n,!0);return a&&(t.$L=a),t},r.clone=function(){return o.w(this.$d,this)},r.toDate=function(){return new Date(this.valueOf())},r.toJSON=function(){return this.isValid()?this.toISOString():null},r.toISOString=function(){return this.$d.toISOString()},r.toString=function(){return this.$d.toUTCString()},s}(),G=F.prototype;return h.prototype=G,[["$ms",k],["$s",g],["$m",D],["$H",m],["$W",v],["$M",c],["$y",b],["$D",T]].forEach(function(s){G[s[1]]=function(r){return this.$g(r,s[0],s[1])}}),h.extend=function(s,r){return s.$i||(s(r,F,h),s.$i=!0),h},h.locale=A,h.isDayjs=R,h.unix=function(s){return h(1e3*s)},h.en=S[L],h.Ls=S,h.p={},h})}(U)),U.exports}var ae=se();const ie=te(ae),ue=()=>{const{property:y}=re(),[j,C]=I.useState(ie().format("YYYY-MM")),[N,H]=I.useState([]),[k,g]=I.useState(!1),[D,m]=I.useState(""),v=async()=>{if(j){g(!0),m("");try{const c=await Z.get(`/billing/${y._id}?period=${j}`);console.log("Bills response:",c.data),H(c.data.bills),c.data.bills.length===0&&m("No bills found for this period.")}catch(c){console.error(c),m("Error fetching bills.")}finally{g(!1)}}},Y=async()=>{if(j){g(!0),m("");try{const c=await Z.post(`/billing/generate/${y._id}`,{period:j});m(c.data.message||"Bills generated successfully."),await v()}catch(c){console.error(c),m("Error generating bills.")}finally{g(!1)}}};return I.useEffect(()=>{const c=async()=>{if(j){g(!0),m("");try{const M=await Z.get(`/billing/${y._id}?period=${j}`);H(M.data.bills),M.data.bills.length===0&&m("No bills found for this period.")}catch(M){console.error(M),m("Error fetching bills.")}finally{g(!1)}}};y!=null&&y._id&&c()},[j,y==null?void 0:y._id]),u.jsxs("div",{className:"p-4 space-y-6",children:[u.jsxs("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium",children:"Billing Period"}),u.jsx("input",{type:"month",value:j,onChange:c=>C(c.target.value),className:"border rounded px-3 py-1 mt-1"})]}),u.jsx("button",{onClick:Y,disabled:k,className:"bg-cyan-700 text-white px-4 py-2 rounded hover:bg-black mt-6",children:k?"Generating...":"Generate Bills"})]}),D&&u.jsx("p",{className:"text-sm text-gray-600",children:D}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full border mt-4",children:[u.jsx("thead",{className:"bg-gray-300",children:u.jsxs("tr",{children:[u.jsx("th",{className:"p-2 border",children:"Tenant"}),u.jsx("th",{className:"p-2 border",children:"Unit"}),u.jsx("th",{className:"p-2 border",children:"Rent"}),u.jsx("th",{className:"p-2 border",children:"Water"}),u.jsx("th",{className:"p-2 border",children:"Garbage"}),u.jsx("th",{className:"p-2 border",children:"Prev Bal"}),u.jsx("th",{className:"p-2 border",children:"Prev Credit"}),u.jsx("th",{className:"p-2 border",children:"Total Due"}),u.jsx("th",{className:"p-2 border",children:"Payments"}),u.jsx("th",{className:"p-2 border",children:"Balance"}),u.jsx("th",{className:"p-2 border",children:"Overpayment"})]})}),u.jsx("tbody",{children:N.map(c=>{var M,b;return u.jsxs("tr",{className:"text-sm text-center",children:[u.jsx("td",{className:"p-2 border",children:(M=c.tenantId)==null?void 0:M.name}),u.jsx("td",{className:"p-2 border",children:c.unitId}),u.jsx("td",{className:"p-2 border",children:c.rent}),u.jsx("td",{className:"p-2 border",children:((b=c.water)==null?void 0:b.amount)||0}),u.jsx("td",{className:"p-2 border",children:c.garbageFee||0}),u.jsx("td",{className:"p-2 border",children:c.carriedBalance||0}),u.jsx("td",{className:"p-2 border",children:c.carriedOverpayment||0}),u.jsx("td",{className:"p-2 border",children:c.totalDue}),u.jsx("td",{className:"p-2 border",children:c.paymentsReceived}),u.jsx("td",{className:"p-2 border",children:c.balance}),u.jsx("td",{className:"p-2 border",children:c.overpayment})]},c._id)})})]})})]})};export{ue as default};
