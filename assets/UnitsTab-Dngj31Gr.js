import{b,r as n,j as e,a as o}from"./index-sFQCxi-d.js";const v=()=>{const{id:r}=b(),[c,x]=n.useState([]),[p,h]=n.useState([]),[m,u]=n.useState(!0),[d,j]=n.useState(""),[l,y]=n.useState("");n.useEffect(()=>{(async()=>{try{const s=await o.get(`/properties/${r}`);x(s.data.units||[]);const a=await o.get(`/tenants?propertyId=${r}`);h(a.data||[])}catch(s){console.error("Error fetching data:",s)}finally{u(!1)}})()},[r]);const g=c.filter(t=>{const s=d?t.type===d:!0,a=t.unitIds.some(i=>l?i.status===l:!0);return s&&a}).map(t=>{const s=t.unitIds.filter(a=>l?a.status===l:!0).map(a=>{const i=p.find(N=>N.unitId===a.unitId);return{...a,tenant:i||null}});return{...t,unitIds:s}});return e.jsxs("div",{className:"p-6 bg-white rounded shadow max-w-5xl mx-auto",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Units"}),m?e.jsx("p",{className:"text-gray-500",children:"Loading units..."}):c.length===0?e.jsx("p",{className:"text-gray-500",children:"No units found for this property."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900",children:"Filter by Type"}),e.jsxs("select",{value:d,onChange:t=>j(t.target.value),className:"mt-1 block w-40 border border-gray-300 rounded px-2 py-1",children:[e.jsx("option",{value:"",children:"All Types"}),[...new Set(c.map(t=>t.type))].map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900",children:"Filter by Status"}),e.jsxs("select",{value:l,onChange:t=>y(t.target.value),className:"mt-1 block w-40 border border-gray-300 rounded px-2 py-1",children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"vacant",children:"Vacant"}),e.jsx("option",{value:"occupied",children:"Occupied"})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full border text-sm",children:[e.jsx("thead",{className:"bg-gray-300 text-left",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-2 px-4",children:"Type"}),e.jsx("th",{className:"py-2 px-4",children:"Rent (KES)"}),e.jsx("th",{className:"py-2 px-4",children:"Deposit (KES)"}),e.jsx("th",{className:"py-2 px-4",children:"Unit ID"}),e.jsx("th",{className:"py-2 px-4",children:"Status"}),e.jsx("th",{className:"py-2 px-4",children:"Tenant"})]})}),e.jsx("tbody",{children:g.map(t=>t.unitIds.map((s,a)=>e.jsxs("tr",{className:"border-b",children:[a===0&&e.jsxs(e.Fragment,{children:[e.jsx("td",{rowSpan:t.unitIds.length,className:"py-2 px-4 font-medium",children:t.type}),e.jsx("td",{rowSpan:t.unitIds.length,className:"py-2 px-4",children:t.rent.toLocaleString()}),e.jsx("td",{rowSpan:t.unitIds.length,className:"py-2 px-4",children:t.deposit.toLocaleString()})]}),e.jsx("td",{className:"py-2 px-4",children:s.unitId}),e.jsx("td",{className:"py-2 px-4",children:s.status}),e.jsx("td",{className:"py-2 px-4",children:s.status==="occupied"&&s.tenant?s.tenant.name:"-"})]},`${s.unitId}-${a}`)))})]})})]})]})};export{v as default};
